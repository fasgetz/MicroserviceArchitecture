(()=>{"use strict";var e,t={401:(e,t,l)=>{var o=l(166);const n={class:"overflow-auto custom-table mt-3"},r={class:"row m-3 justify-content-between"},s={class:"col-12 col-lg-6"},a={class:"d-flex"},i={class:"col-12 col-lg-6"},c={class:"d-flex align-items-center"},u=(0,o._)("div",{class:"align-items-center m-3"},"Department",-1),d=(0,o._)("option",{value:"0"},"Весь список",-1),p=["value"],m={class:"table"},f=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",{scope:"col"},"Name"),(0,o._)("th",{scope:"col"},"Email"),(0,o._)("th",{scope:"col"},"FirstName"),(0,o._)("th",{scope:"col"},"LastName"),(0,o._)("th",{scope:"col"},"Department"),(0,o._)("th",{scope:"col"})])],-1),h={class:"d-flex"},b={class:"p-1"},_=["onClick"],g={class:"p-1"},v=["onClick"];var w=l(669),y=l.n(w);const D=(0,o._)("h3",null,"Добавление пользователя",-1),x=(0,o._)("h5",null,"Account",-1),T={class:"form-group"},A=(0,o._)("label",null,"Name",-1),O={class:"form-group"},C=(0,o._)("label",null,"Email",-1),N={class:"error-msg"},k={class:"row m-0 justify-content-end"},E={class:"p-3"},U=(0,o._)("div",{class:"p-3"},[(0,o._)("button",{type:"submit",class:"btn btn-success"},"Добавить")],-1),j={name:"addcomponent",data:()=>({accountErrors:null,name:null,email:null}),computed:{},methods:{addAccount(){let e={name:this.name,email:this.email};y().post("https://blog.learn-courses.ru/gateway/account",e).then((e=>{this.$emit("added-account",e.data)})).catch((e=>{this.accountErrors=e.response.data.errors,console.log(e.response.data.errors)}))},close(){this.$emit("close-component")}},mounted(){},render:function(e,t,l,n,r,s){return(0,o.wg)(),(0,o.iD)("div",null,[D,(0,o._)("form",{onSubmit:t[3]||(t[3]=(0,o.iM)(((...e)=>s.addAccount&&s.addAccount(...e)),["prevent"]))},[x,(0,o._)("div",T,[A,(0,o.wy)((0,o._)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>r.name=e),class:"form-control",placeholder:"Введите имя"},null,512),[[o.nr,r.name]])]),(0,o._)("div",O,[C,(0,o.wy)((0,o._)("input",{type:"email","onUpdate:modelValue":t[1]||(t[1]=e=>r.email=e),class:"form-control",placeholder:"Введите email"},null,512),[[o.nr,r.email]])]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.accountErrors,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:"text-danger",key:t},[(0,o._)("div",N,(0,o.zw)(e[0]),1)])))),128)),(0,o._)("div",k,[(0,o._)("div",E,[(0,o._)("button",{class:"btn btn-primary",onClick:t[2]||(t[2]=(...e)=>s.close&&s.close(...e))},"Отменить")]),U])],32)])}},z={class:"container"},M=(0,o._)("h3",null,"Редактирование пользователя",-1),P=(0,o._)("h5",null,"Account",-1),S={class:"form-group"},L=(0,o._)("label",null,"Name",-1),V={class:"form-group"},H=(0,o._)("label",null,"Email",-1),K={class:"error-msg"},Y=(0,o._)("div",{class:"row m-0 justify-content-end"},[(0,o._)("button",{type:"submit",class:"btn btn-success"},"Сохранить")],-1),I=(0,o._)("h5",null,"Profile",-1),R={class:"form-group"},$=(0,o._)("label",null,"firstName",-1),J={class:"form-group"},F=(0,o._)("label",null,"lastName",-1),q={class:"form-group"},G=(0,o._)("label",null,"Department",-1),B=["value"],Q={class:"error-msg"},W={class:"row m-0 justify-content-end"},X={class:"p-3"},Z=(0,o._)("div",{class:"p-3"},[(0,o._)("button",{type:"submit",class:"btn btn-success"},"Сохранить")],-1),ee={name:"tablecomponent",components:{addcomponent:j,editcomponent:{name:"editcomponent",props:["item"],setup:()=>({state:(0,o.f3)("state")}),data:()=>({accountErrors:null,profileErrors:null}),computed:{},methods:{close(){this.$emit("close-component")},saveAccount(){y().put("https://blog.learn-courses.ru/gateway/account",this.item).then((e=>{this.$emit("update-account",this.item)})).catch((e=>{this.accountErrors=e.response.data.errors,console.log(e.response.data.errors)}))},saveProfile(){y().put("https://blog.learn-courses.ru/gateway/profile",this.item.profile).then((e=>{this.$emit("update-account",this.item)})).catch((e=>{this.profileErrors=e.response.data.errors,console.log(e.response.data.errors)}))}},created(){},beforeMount(){},mounted(){},render:function(e,t,l,n,r,s){return(0,o.wg)(),(0,o.iD)("div",z,[M,(0,o._)("form",{onSubmit:t[2]||(t[2]=(0,o.iM)(((...e)=>s.saveAccount&&s.saveAccount(...e)),["prevent"]))},[P,(0,o._)("div",S,[L,(0,o.wy)((0,o._)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>l.item.name=e),class:"form-control",placeholder:"Введите имя"},null,512),[[o.nr,l.item.name]])]),(0,o._)("div",V,[H,(0,o.wy)((0,o._)("input",{type:"email","onUpdate:modelValue":t[1]||(t[1]=e=>l.item.email=e),class:"form-control",placeholder:"Введите email"},null,512),[[o.nr,l.item.email]])]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.accountErrors,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:"text-danger",key:t},[(0,o._)("div",K,(0,o.zw)(e[0]),1)])))),128)),Y],32),(0,o._)("form",{class:"mt-3",onSubmit:t[7]||(t[7]=(0,o.iM)(((...e)=>s.saveProfile&&s.saveProfile(...e)),["prevent"]))},[I,(0,o._)("div",R,[$,(0,o.wy)((0,o._)("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>l.item.profile.firstName=e),class:"form-control",placeholder:"Введите firstName"},null,512),[[o.nr,l.item.profile.firstName]])]),(0,o._)("div",J,[F,(0,o.wy)((0,o._)("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>l.item.profile.lastName=e),class:"form-control",placeholder:"Введите lastName"},null,512),[[o.nr,l.item.profile.lastName]])]),(0,o._)("div",q,[G,(0,o.wy)((0,o._)("select",{class:"form-control","onUpdate:modelValue":t[5]||(t[5]=e=>l.item.profile.idDepartment=e)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.state.departments,(e=>((0,o.wg)(),(0,o.iD)("option",{value:e.id},(0,o.zw)(e.title),9,B)))),256))],512),[[o.bM,l.item.profile.idDepartment]])]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.profileErrors,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:"text-danger",key:t},[(0,o._)("div",Q,(0,o.zw)(e[0]),1)])))),128)),(0,o._)("div",W,[(0,o._)("div",X,[(0,o._)("button",{class:"btn btn-primary",onClick:t[6]||(t[6]=(...e)=>s.close&&s.close(...e))},"Отменить")]),Z])],32)])}}},setup(){const e=(0,o.qj)({departments:null});return(0,o.JJ)("state",e),{state:e}},data:()=>({selectedDepartment:0,selectedUser:null,filterText:"",users:null,departments:null,currentTab:"",tabs:["addcomponent","editcomponent"]}),computed:{filteredList(){if(this.filterText||this.selectedDepartment){const e=e=>e.name.toLowerCase().includes(this.filterText)||e.email.toLowerCase().includes(this.filterText);let t=this.users.filter(e);return 0!=this.selectedDepartment&&(t=t.filter((e=>e.profile.idDepartment==this.selectedDepartment))),t}return this.users},currentTabComponent(){return this.currentTab.toLowerCase()},currentProperties:function(){if("editcomponent"===this.currentTab)return{item:this.selectedUser};console.log("elsed")}},methods:{addedAccount:function(e){console.log(e),this.users.push(e),this.deleteThisRow()},deleteItem:function(e){this.deleteThisRow(),y().delete("https://blog.learn-courses.ru/gateway/account",{params:{id:e.id}}).then((t=>{let l=this.users.map((e=>e.id)).indexOf(e.id);this.users.splice(l,1)})).catch((e=>{console.log(e.response.data.errors)}))},updateAccount:function(e){let t=this.users.map((e=>e.id)).indexOf(e.id),l=this.departments.map((e=>e.id)).indexOf(e.profile.idDepartment);console.log("indexDepartUpdate: ",l),null!=e.profile.idDepartment?(console.log("is NOT null:",e.profile),e.profile.department={title:this.departments[l].title}):console.log("is null:",e.profile),this.users[t]=e,this.deleteThisRow()},addAccount:function(){this.currentTab="addcomponent"},editItem:function(e){this.selectedUser=JSON.parse(JSON.stringify(e)),this.currentTab="editcomponent",console.log(e)},deleteThisRow:function(){this.currentTab=""}},beforeMount(){y().get("https://blog.learn-courses.ru/gateway/department").then((e=>{this.departments=e.data,this.state.departments=e.data})).catch((e=>{alert("error id")})),y().get("https://blog.learn-courses.ru/gateway/users").then((e=>{this.users=e.data})).catch((e=>{alert("error id")}))},mounted(){},render:function(e,t,l,w,y,D){return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",null,[(0,o._)("div",n,[(0,o._)("div",r,[(0,o._)("div",s,[(0,o._)("div",a,[(0,o._)("button",{onClick:t[0]||(t[0]=(...e)=>D.addAccount&&D.addAccount(...e)),class:"btn btn-primary m-3"},"+"),(0,o.wy)((0,o._)("input",{class:"form-control m-3",placeholder:"Значение для фильтрации",type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>y.filterText=e)},null,512),[[o.nr,y.filterText]])])]),(0,o._)("div",i,[(0,o._)("div",c,[u,(0,o.wy)((0,o._)("select",{class:"form-control m-3","onUpdate:modelValue":t[2]||(t[2]=e=>y.selectedDepartment=e)},[d,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(y.departments,(e=>((0,o.wg)(),(0,o.iD)("option",{value:e.id},(0,o.zw)(e.title),9,p)))),256))],512),[[o.bM,y.selectedDepartment]])])])]),(0,o._)("table",m,[f,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(D.filteredList,(e=>((0,o.wg)(),(0,o.iD)("tbody",{key:e},[(0,o._)("tr",null,[(0,o._)("td",null,(0,o.zw)(e.name),1),(0,o._)("td",null,(0,o.zw)(e.email),1),(0,o._)("td",null,(0,o.zw)(e.profile.firstName),1),(0,o._)("td",null,(0,o.zw)(e.profile.lastName),1),(0,o._)("td",null,(0,o.zw)(null!=e.profile.department?e.profile.department.title:null),1),(0,o._)("td",null,[(0,o._)("div",h,[(0,o._)("div",b,[(0,o._)("button",{class:"btn btn-primary",onClick:t=>D.editItem(e)},"EDIT",8,_)]),(0,o._)("div",g,[(0,o._)("button",{class:"btn btn-danger",onClick:t=>D.deleteItem(e)},"DEL",8,v)])])])])])))),128))])])]),((0,o.wg)(),(0,o.j4)((0,o.LL)(D.currentTabComponent),(0,o.dG)(D.currentProperties,{onAddedAccount:D.addedAccount,onUpdateAccount:D.updateAccount,onCloseComponent:D.deleteThisRow}),null,16,["onAddedAccount","onUpdateAccount","onCloseComponent"]))])}};(0,o.ri)({components:{tablecomponent:ee},data:()=>({}),computed:{},methods:{},mounted(){}}).mount("#app")}},l={};function o(e){var n=l[e];if(void 0!==n)return n.exports;var r=l[e]={exports:{}};return t[e](r,r.exports,o),r.exports}o.m=t,e=[],o.O=(t,l,n,r)=>{if(!l){var s=1/0;for(u=0;u<e.length;u++){for(var[l,n,r]=e[u],a=!0,i=0;i<l.length;i++)(!1&r||s>=r)&&Object.keys(o.O).every((e=>o.O[e](l[i])))?l.splice(i--,1):(a=!1,r<s&&(s=r));if(a){e.splice(u--,1);var c=n();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[l,n,r]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var l in t)o.o(t,l)&&!o.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={761:0};o.O.j=t=>0===e[t];var t=(t,l)=>{var n,r,[s,a,i]=l,c=0;if(s.some((t=>0!==e[t]))){for(n in a)o.o(a,n)&&(o.m[n]=a[n]);if(i)var u=i(o)}for(t&&t(l);c<s.length;c++)r=s[c],o.o(e,r)&&e[r]&&e[r][0](),e[s[c]]=0;return o.O(u)},l=self.webpackChunkmyapplication=self.webpackChunkmyapplication||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))})();var n=o.O(void 0,[998],(()=>o(401)));n=o.O(n)})();